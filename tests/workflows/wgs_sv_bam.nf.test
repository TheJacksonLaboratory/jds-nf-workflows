nextflow_workflow {

    name "Test Workflow WGS_SV_BAM"
    script "workflows/wgs_sv_bam.nf"
    workflow "WGS_SV_BAM"

    test("Full Workflow -- Mouse -- GRCm38") {
        tag "GRCm38"
        tag "primary"
        options "-stub-run"
        when {
            params {
                gen_org = "mouse"
                csv_input = "https://raw.githubusercontent.com/TheJacksonLaboratory/jds-nf-test/refs/heads/main/wgs/sv/mouse/wgs_sv_bam_input.csv"
                pubdir = "tests/results"
                pipeline = 'wgs_sv_bam'
            }
        }

        then {
            assert workflow.success
        }

    }

    test("Full Workflow -- Mouse -- GRCm39") { // This fails because the BAM is in the wrong coordinates. 
        tag "GRCm38"
        tag "primary"
        options "-stub-run"
        when {
            params {
                gen_org = "mouse"
                genome_build = "GRCm39"
                csv_input = "https://raw.githubusercontent.com/TheJacksonLaboratory/jds-nf-test/refs/heads/main/wgs/sv/mouse/wgs_sv_bam_input.csv"
                pubdir = "tests/results"
                pipeline = 'wgs_sv_bam'
            }
        }

        then {
            assert workflow.failed
        }

    }

    test("Full Workflow -- Human") {
        tag "GRCm38"
        tag "primary"
        options "-stub-run"
        when {
            params {
                gen_org = "human"
                csv_input = "https://raw.githubusercontent.com/TheJacksonLaboratory/jds-nf-test/refs/heads/main/wgs/sv/human/wgs_sv_bam_input.csv"
                pubdir = "tests/results"
                pipeline = 'wgs_sv_bam'
            }
        }

        then {
            assert workflow.success
        }

    }

}
